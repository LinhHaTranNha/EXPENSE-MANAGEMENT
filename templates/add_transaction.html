<link rel="stylesheet" href="../static/css/add_transaction.css" />
<title>Add Transaction - FinMan</title>
<link rel="icon" type="image/png" href="../static/image/money.jpg" />


<div class="transaction-container">
    <h2>Add Transaction</h2>
    <p>Track your expenses and savings efficiently.</p>

    <form method="POST" class="transaction-form">
        {{ form.hidden_tag() }}

        <p class="input-icon">
            <label for="transaction_date">Transaction Date</label>
            <i class="fas fa-calendar-alt"></i>
            {{ form.transaction_date(class="form-control") }}
        </p>

        <!-- 🟢 Chọn loại giao dịch -->
        <p class="input-icon">
            <label for="transaction_type">Transaction Type</label>
            <i class="fas fa-exchange-alt"></i>
            <select id="transaction_type" name="transaction_type" class="form-control" required>
                <option value="expense">Expense</option>
                <option value="income">Income</option>
                <option value="saving">Saving</option>
            </select>
        </p>

        <p class="input-icon">
            <label for="categorySelect">Category</label>
            <i class="fas fa-list-ul"></i>
            <select id="categorySelect" name="category_name" class="form-control">
                <option value="" disabled selected>-- Select a category --</option>
                {% for category in categories %}
                <option value="{{ category.name }}">{{ category.name }}</option>
                {% endfor %}
                <option value="other">Other (Enter new category)</option>
            </select>
        </p>

        <p id="newCategoryContainer">
            <label for="newCategory">New Category</label>
            <input type="text" id="newCategory" name="new_category" class="form-control">
        </p>

        <p class="input-icon">
            <label for="transaction_amount">Amount</label>
            <i class="fas fa-money-bill-wave"></i>
            {{ form.transaction_amount(class="form-control") }}
        </p>

        <p><button type="submit">Submit</button></p>
    </form>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        let categorySelect = document.getElementById("categorySelect");
        let newCategoryContainer = document.getElementById("newCategoryContainer");
        let newCategoryInput = document.getElementById("newCategory");

        categorySelect.addEventListener("change", function () {
            if (this.value === "other") {
                newCategoryContainer.style.display = "block";
                newCategoryInput.setAttribute("required", "required");
            } else {
                newCategoryContainer.style.display = "none";
                newCategoryInput.removeAttribute("required");
            }
        });

        document.querySelector("[name=transaction_date]").setAttribute("type", "date");
    });

    document.addEventListener("DOMContentLoaded", function () {
        let transactionDateInput = document.querySelector("[name=transaction_date]");

        if (transactionDateInput) {
            let today = new Date();
            let formattedDate = today.toISOString().split("T")[0]; // Format YYYY-MM-DD
            transactionDateInput.value = formattedDate;
        }
    });
</script>